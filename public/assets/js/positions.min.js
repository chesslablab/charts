const script=document.getElementById("theScript"),scheme=script.getAttribute("data-scheme"),host=script.getAttribute("data-host"),port=script.getAttribute("data-port"),gameForm=document.getElementById("gameForm"),tutor=document.getElementById("tutor"),chessboard=document.getElementById("chessboard");gameForm.querySelector("button").onclick=e=>{for(e.preventDefault();tutor.firstChild;)tutor.removeChild(tutor.firstChild);for(;chessboard.firstChild;)chessboard.removeChild(chessboard.firstChild);document.getElementById("tutor").style.display="none",document.getElementById("spinner").style.display="block";let t=fetch(`${scheme}://${host}:${port}/api/tutor/fen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fen:gameForm.querySelector("input").value})}).then(e=>e.json()).then(e=>{let t=document.createElement("p");t.appendChild(document.createTextNode(`Here is a description of this position. ${e.paragraph}`)),tutor.appendChild(t)}),o=fetch(`${scheme}://${host}:${port}/api/download/image`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fen:gameForm.querySelector("input").value})}).then(e=>{e.blob().then(e=>{let t=window.URL||window.webkitURL,o=document.createElement("img");o.src=t.createObjectURL(e),o.classList.add("img-fluid"),chessboard.appendChild(o)})});Promise.all([t,o]).catch(e=>{alert("Whoops! Something went wrong, please try again.")}).finally(()=>{document.getElementById("spinner").style.display="none",document.getElementById("tutor").style.display="block"})};
