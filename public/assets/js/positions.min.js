const script=document.getElementById("theScript"),scheme=script.getAttribute("data-scheme"),host=script.getAttribute("data-host"),port=script.getAttribute("data-port"),gameForm=document.getElementById("gameForm"),tutor=document.getElementById("tutor"),chessboard=document.getElementById("chessboard"),reset=()=>{for(;tutor.firstChild;)tutor.removeChild(tutor.firstChild);for(;chessboard.firstChild;)chessboard.removeChild(chessboard.firstChild);document.getElementById("validation").style.display="none",document.getElementById("chessboard").style.display="none",document.getElementById("tutor").style.display="none",document.getElementById("spinner").style.display="block"},promise=e=>{let t=fetch(`${scheme}://${host}:${port}/api/tutor/fen`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fen:e})}).then(e=>e.json()).then(e=>{let t=document.createElement("p");t.appendChild(document.createTextNode(`Here is a description of this position. ${e.paragraph}`)),tutor.appendChild(t)}),s=fetch(`${scheme}://${host}:${port}/api/download/image`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fen:e})}).then(e=>{e.blob().then(e=>{let t=window.URL||window.webkitURL,s=document.createElement("img");s.src=t.createObjectURL(e),s.classList.add("img-fluid"),chessboard.appendChild(s)})});Promise.all([t,s]).then(()=>{document.getElementById("chessboard").style.display="block",document.getElementById("tutor").style.display="block"}).catch(e=>{document.getElementById("validation").style.display="block"}).finally(()=>{document.getElementById("spinner").style.display="none"})};gameForm.querySelector("button").onclick=e=>{e.preventDefault(),reset(),promise(gameForm.querySelector("input").value)},document.querySelector("select").onchange=async e=>{e.preventDefault(),reset(),promise(e.target.value)};
