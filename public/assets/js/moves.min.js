const script=document.getElementById("theScript"),scheme=script.getAttribute("data-scheme"),host=script.getAttribute("data-host"),port=script.getAttribute("data-port"),gameForm=document.getElementById("gameForm"),tutor=document.getElementById("tutor"),chessboard=document.getElementById("chessboard"),fen=document.getElementById("fen");gameForm.querySelector("button").onclick=e=>{for(e.preventDefault();tutor.firstChild;)tutor.removeChild(tutor.firstChild);for(;chessboard.firstChild;)chessboard.removeChild(chessboard.firstChild);document.getElementById("fen").style.display="none",document.getElementById("tutor").style.display="none",document.getElementById("spinner").style.display="block";let t=fetch(`${scheme}://${host}:${port}/api/tutor/pgn`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fen:gameForm.querySelector("input").value})}).then(e=>e.json()).then(e=>{let t=document.createElement("p"),n=document.createElement("p");t.appendChild(document.createTextNode(`Here is a description of this position. ${e.fenExplanation}`)),n.appendChild(document.createTextNode(`${e.pgn} is a good move! It changes the position as described next. ${e.pgnExplanation}`)),tutor.appendChild(t),tutor.appendChild(n),fen.querySelector("input").value=e.fen}),n=fetch(`${scheme}://${host}:${port}/api/download/image`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fen:gameForm.querySelector("input").value})}).then(e=>{e.blob().then(e=>{let t=window.URL||window.webkitURL,n=document.createElement("img");n.src=t.createObjectURL(e),n.classList.add("img-fluid"),chessboard.appendChild(n)})});Promise.all([t,n]).then(()=>{document.getElementById("fen").style.display="flex",document.getElementById("tutor").style.display="block"}).catch(e=>{alert("Whoops! Something went wrong, please try again.")}).finally(()=>{document.getElementById("spinner").style.display="none"})},fen.querySelector("button").onclick=e=>{let t=fen.querySelector("input").value;navigator.clipboard.writeText(t)};
